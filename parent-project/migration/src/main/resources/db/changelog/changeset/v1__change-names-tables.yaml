databaseChangeLog:
  - changeSet:
      id: rename-tables-to-lowercase
      author: Roman Makulin
      changes:
        # Переименование таблиц
        - renameTable:
            oldTableName: "Role"
            newTableName: "role"
        - renameTable:
            oldTableName: "AppUser"
            newTableName: "app_user"
        - renameTable:
            oldTableName: "Status"
            newTableName: "status"
        - renameTable:
            oldTableName: "Location"
            newTableName: "location"
        - renameTable:
            oldTableName: "Profile_Status"
            newTableName: "profile_status"
        - renameTable:
            oldTableName: "Profile"
            newTableName: "profile"
        - renameTable:
            oldTableName: "Direction"
            newTableName: "direction"
        - renameTable:
            oldTableName: "Profile_Direction"
            newTableName: "profile_direction"
        - renameTable:
            oldTableName: "File"
            newTableName: "file"
        - renameTable:
            oldTableName: "Profile_File"
            newTableName: "profile_file"
        - renameTable:
            oldTableName: "Plan"
            newTableName: "plan"
        - renameTable:
            oldTableName: "Profile_Plan"
            newTableName: "profile_plan"

  - changeSet:
      id: update-foreign-keys-to-lowercase
      author: Roman Makulin
      changes:
        # Обновление внешних ключей
        - dropForeignKeyConstraint:
            baseTableName: app_user
            constraintName: fk_appuser_role
        - addForeignKeyConstraint:
            baseTableName: app_user
            baseColumnNames: role_id
            referencedTableName: role
            referencedColumnNames: id
            constraintName: fk_app_user_role

        - dropForeignKeyConstraint:
            baseTableName: profile
            constraintName: fk_profile_user
        - addForeignKeyConstraint:
            baseTableName: profile
            baseColumnNames: user_id
            referencedTableName: app_user
            referencedColumnNames: id
            constraintName: fk_profile_app_user

        - dropForeignKeyConstraint:
            baseTableName: profile
            constraintName: fk_profile_location
        - addForeignKeyConstraint:
            baseTableName: profile
            baseColumnNames: location_id
            referencedTableName: location
            referencedColumnNames: id
            constraintName: fk_profile_location

        - dropForeignKeyConstraint:
            baseTableName: profile
            constraintName: fk_profile_status
        - addForeignKeyConstraint:
            baseTableName: profile
            baseColumnNames: status_id
            referencedTableName: profile_status
            referencedColumnNames: id
            constraintName: fk_profile_profile_status

        - dropForeignKeyConstraint:
            baseTableName: profile_direction
            constraintName: fk_profile_direction_profile
        - addForeignKeyConstraint:
            baseTableName: profile_direction
            baseColumnNames: profile_id
            referencedTableName: profile
            referencedColumnNames: id
            constraintName: fk_profile_direction_profile

        - dropForeignKeyConstraint:
            baseTableName: profile_direction
            constraintName: fk_profile_direction_direction
        - addForeignKeyConstraint:
            baseTableName: profile_direction
            baseColumnNames: direction_id
            referencedTableName: direction
            referencedColumnNames: id
            constraintName: fk_profile_direction_direction

        - dropForeignKeyConstraint:
            baseTableName: profile_file
            constraintName: fk_profile_file_profile
        - addForeignKeyConstraint:
            baseTableName: profile_file
            baseColumnNames: profile_id
            referencedTableName: profile
            referencedColumnNames: id
            constraintName: fk_profile_file_profile

        - dropForeignKeyConstraint:
            baseTableName: profile_file
            constraintName: fk_profile_file_file
        - addForeignKeyConstraint:
            baseTableName: profile_file
            baseColumnNames: file_id
            referencedTableName: file
            referencedColumnNames: id
            constraintName: fk_profile_file_file

        - dropForeignKeyConstraint:
            baseTableName: profile_plan
            constraintName: fk_profile_plan_plan
        - addForeignKeyConstraint:
            baseTableName: profile_plan
            baseColumnNames: plan_id
            referencedTableName: plan
            referencedColumnNames: id
            constraintName: fk_profile_plan_plan

        - dropForeignKeyConstraint:
            baseTableName: profile_plan
            constraintName: fk_profile_plan_profile
        - addForeignKeyConstraint:
            baseTableName: profile_plan
            baseColumnNames: profile_id
            referencedTableName: profile
            referencedColumnNames: id
            constraintName: fk_profile_plan_profile
